(()=>{"use strict";const e=window.wp.element,t=window.wp.blockEditor,a=window.wp.components,l=window.wp.blocks,n=JSON.parse('{"u2":"cofctheme/media-carousel"}'),i=({attributes:t})=>{const{title:a,description:l,mediaItems:n,includeLink:i,linkUri:r,linkText:c,linkNewTab:o}=t;return(0,e.createElement)("section",{className:"media  media--wide media--gallery component js-has-carousel"},(0,e.createElement)("div",{className:"media__gridtop media-grids"}),(0,e.createElement)("div",{className:"media__container"},(0,e.createElement)("div",{className:"media__header"},(0,e.createElement)("h2",{className:"media__title font-h2 hide-for-large"},a),(0,e.createElement)("div",{className:"hr__wrapper hide-for-large"},(0,e.createElement)("hr",null))),(0,e.createElement)("div",{className:"media__wrapper"},(0,e.createElement)("div",{id:"media_items",className:"media__items"},n.map(((t,a)=>{if("video"===t.type){const l=`https://img.youtube.com/vi/${(e=>{let t="";const a=e.match(/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|[^#]*[?&]v=|youtu\.be\/|embed\/?|\/v\/|\/e\/|watch\?v=|[^#]*[?&]v=))([a-zA-Z0-9_-]{11})/);return a&&a[1]&&(t=a[1]),t})(t.url)}/hqdefault.jpg`;return(0,e.createElement)("figure",{key:a,id:t.id,className:"media__imagery media__imagery--with-video"},(0,e.createElement)("img",{src:l,alt:t.title,className:"media__image"}),(0,e.createElement)("a",{href:t.url,className:"btn btn--xlarge btn--round play-button"},(0,e.createElement)("span",{className:"btn__icon"},(0,e.createElement)("svg",{className:"brei-icon brei-icon-play",focusable:"false"},(0,e.createElement)("use",{href:"#brei-icon-play"}))),(0,e.createElement)("span",{className:"show-for-sr"},"Play video")),(0,e.createElement)("figcaption",null,t.caption))}if("image"===t.type)return(0,e.createElement)("figure",{key:a,id:t.id,className:"media__imagery"},(0,e.createElement)("img",{src:t.url,alt:t.alt,className:"media__image"}),(0,e.createElement)("figcaption",null,t.caption))}))),(0,e.createElement)("div",{className:"media__controls","data-id":"media_controls"},(0,e.createElement)("div",{"data-id":"next"},(0,e.createElement)("a",{href:"#","aria-label":"See Next",className:"btn btn--medium"},(0,e.createElement)("span",{className:"btn__icon"},(0,e.createElement)("svg",{className:"brei-icon brei-icon-chevron",focusable:"false"},(0,e.createElement)("use",{href:"#brei-icon-chevron"}))))),(0,e.createElement)("div",{className:"media-amount"}),(0,e.createElement)("div",{"data-id":"prev"},(0,e.createElement)("a",{href:"#","aria-label":"See Previous",className:"btn btn--medium"},(0,e.createElement)("span",{className:"btn__icon"},(0,e.createElement)("svg",{className:"brei-icon brei-icon-chevron",focusable:"false"},(0,e.createElement)("use",{href:"#brei-icon-chevron"})))))),(0,e.createElement)("div",{className:"media__caption font-caption","aria-hidden":"true"}),(0,e.createElement)("div",{className:"media__controls","data-id":"media_controls_sm"},(0,e.createElement)("div",{"data-id":"prev"},(0,e.createElement)("a",{href:"#","aria-label":"See Previous",className:"btn btn--medium"},(0,e.createElement)("span",{className:"btn__icon"},(0,e.createElement)("svg",{className:"brei-icon brei-icon-chevron",focusable:"false"},(0,e.createElement)("use",{href:"#brei-icon-chevron"}))))),(0,e.createElement)("div",{className:"media-amount"}),(0,e.createElement)("div",{"data-id":"next"},(0,e.createElement)("a",{href:"#","aria-label":"See Next",className:"btn btn--medium"},(0,e.createElement)("span",{className:"btn__icon"},(0,e.createElement)("svg",{className:"brei-icon brei-icon-chevron",focusable:"false"},(0,e.createElement)("use",{href:"#brei-icon-chevron"}))))))),(0,e.createElement)("div",{className:"media__footer"},(0,e.createElement)("p",{className:"media__title font-h2 show-for-large","aria-hidden":"true"},a),(0,e.createElement)("div",{className:"hr__wrapper show-for-large"},(0,e.createElement)("hr",null)),l&&(0,e.createElement)("p",{className:"media__copy font-body-lite"},l),i?(0,e.createElement)("a",{href:r,className:"btn btn-tertiary btn-tertiary-left",target:o?"_blank":"_self",rel:o?"noopener noreferrer":""},(0,e.createElement)("span",{className:"text"},c||"View More"),(0,e.createElement)("span",{className:"text-arrow"},(0,e.createElement)("svg",{className:"brei-icon brei-icon-arrows",focusable:"false"},(0,e.createElement)("use",{href:"#brei-icon-arrows"})),(0,e.createElement)("svg",{className:"brei-icon brei-icon-arrows-arrow",focusable:"false"},(0,e.createElement)("use",{href:"#brei-icon-arrows-arrow"})))):"")),(0,e.createElement)("div",{className:"media__gridbottom media-grids"}))},r=window.React,c=({onSelectVideo:t,selectedVideoLink:l,selectedVideoCaption:n,selectedVideoTitle:i,setSelectedVideoLink:r,setSelectedVideoCaption:c,setSelectedVideoTitle:o})=>(0,e.createElement)("div",{className:"video-fields",style:{display:"block",margin:"1rem"}},(0,e.createElement)(a.TextControl,{type:"url",label:"Video Link",placeholder:"Enter YouTube Video link",value:l,onChange:e=>{r(e)}}),(0,e.createElement)(a.TextareaControl,{label:"Video Caption",value:n,onChange:e=>{c(e)}}),(0,e.createElement)(a.TextControl,{label:"Video Title",value:i,onChange:e=>{o(e)}}),(0,e.createElement)(a.Button,{className:"components-button is-primary",onClick:()=>{t(l,n,i)}},"Save Video"));(0,l.registerBlockType)(n.u2,{title:"CofC Media Carousel",edit:({attributes:l,setAttributes:n,isSelected:i})=>{const[o,s]=(0,r.useState)(!1),[m,d]=(0,r.useState)(""),[u,E]=(0,r.useState)(null),[p,b]=(0,r.useState)(""),[h,v]=(0,r.useState)(""),[g,f]=(0,r.useState)(""),{title:N,description:_,mediaItems:k,includeLink:y,linkUri:C,linkText:w,linkNewTab:T}=l,V=()=>{s(!1),d("")},S=(e,t,a)=>{if(u){let l=k.filter((e=>e.id===u))[0];l.caption=t,l.title=a,l.url=e;const i=[...k];i.splice(k.indexOf(l),1,l),n({mediaItems:i}),E(null)}else{const l={id:Math.floor(1e4*Math.random()),url:e,type:"video",caption:t||"",title:a||""};n({mediaItems:[...k,l]}),V()}},x=e=>{const t=[...k];t.splice(e,1),n({mediaItems:t})},I=(0,t.useBlockProps)({className:"custom-block "+(i?"is-selected":"")});return(0,e.createElement)("div",I,(0,e.createElement)(t.InspectorControls,null,(0,e.createElement)(a.PanelBody,{title:"Block Settings",initialOpen:!0},(0,e.createElement)("p",null,"Your carousel can include both images and videos. Videos must be stored on YouTube to be used in the carousel."),(0,e.createElement)(a.TextControl,{label:"Title",help:"What should the heading above the carousel say?",value:N,onChange:e=>{n({title:e})}}),(0,e.createElement)(a.TextareaControl,{label:"Description",help:"What should the description below the carousel say?",value:_,onChange:e=>{n({description:e})}}),(0,e.createElement)(a.ToggleControl,{label:"Include a link below the carousel to another page?",checked:y,onChange:e=>{n({includeLink:e})}}),y?(0,e.createElement)(e.Fragment,null,(0,e.createElement)(a.ToggleControl,{label:"Open in a New Tab?",checked:T,onChange:e=>{n({linkNewTab:e})}}),(0,e.createElement)(a.TextControl,{label:"Link Text",help:"What text should display for the link?",onChange:e=>{n({linkText:e})},value:w}),(0,e.createElement)(a.TextControl,{label:"Link URI",help:"Provide the URL to link to",onChange:e=>{n({linkUri:e})},type:"url",value:C})):"",k.length>0?(0,e.createElement)("div",{class:"carousel-preview"},(0,e.createElement)("h3",null,"Carousel Items:"),(0,e.createElement)("hr",null),k.map(((t,l)=>(0,e.createElement)("div",{style:{marginBottom:"1rem",borderBottom:"1px solid blue",paddingBottom:"1rem"},key:l,className:"carousel-item-preview",draggable:"true",onDragStart:e=>{e.dataTransfer.setData("text/plain",l)},onDragOver:e=>{e.preventDefault()},onDrop:e=>{const t=e.dataTransfer.getData("text/plain"),a=l,i=[...k],r=i[t];i[t]=i[a],i[a]=r,n({mediaItems:i})},"data-itemid":t.id},"image"===t.type&&(0,e.createElement)("div",null,(0,e.createElement)("img",{src:t.url,alt:"Selected Image"}),(0,e.createElement)("div",{style:{display:"block",margin:"0.5rem 0"}},(0,e.createElement)("h4",null,t.title),(0,e.createElement)("p",null,t.caption)),(0,e.createElement)(a.Button,{className:"components-button is-destructive",onClick:()=>x(l)},(0,e.createElement)(a.Dashicon,{icon:"trash"}),"Remove Image")),"video"===t.type&&u!==t.id&&(0,e.createElement)("div",null,(0,e.createElement)("video",{id:`video-${t.id}`,src:t.url,controls:!0}),(0,e.createElement)("div",{style:{display:"block",margin:"0.5rem 0"}},(0,e.createElement)("h4",null,t.title),(0,e.createElement)("p",null,t.caption)),(0,e.createElement)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",margin:"0.5rem 0"}},(0,e.createElement)(a.Button,{className:"components-button is-destructive",onClick:()=>x(l)},(0,e.createElement)(a.Dashicon,{icon:"trash"}),"Remove Video"),(0,e.createElement)(a.Button,{className:"components-button is-primary",onClick:()=>{E(t.id),b(t.url),v(t.title),f(t.caption)}},(0,e.createElement)(a.Dashicon,{icon:"edit"}),"Edit Video Info"))),"video"===t.type&&u===t.id&&(0,e.createElement)("div",null,(0,e.createElement)(c,{onSelectVideo:S,selectedVideoCaption:g,selectedVideoLink:p,selectedVideoTitle:h,setSelectedVideoCaption:f,setSelectedVideoLink:b,setSelectedVideoTitle:v})))))):(0,e.createElement)("p",null,"No items in carousel."),(0,e.createElement)("div",{style:{textAlign:"center"}},(0,e.createElement)(a.Button,{className:"components-button is-primary",style:{margin:".5rem"},onClick:()=>{s(!0)}},"Add Item to Carousel"),(0,e.createElement)(t.MediaUploadCheck,null,o&&(0,e.createElement)("div",{className:"media-dialog"},(0,e.createElement)("h3",null,"Select Media Type"),(0,e.createElement)(a.Button,{onClick:()=>d("image")},"Image"),(0,e.createElement)(a.Button,{onClick:()=>d("video")},"Video"),"image"===m&&(0,e.createElement)(t.MediaUpload,{onSelect:e=>{n({mediaItems:[...k,...e]}),V()},allowedTypes:["image"],multiple:!0,gallery:!1,value:null,render:({open:t})=>(0,e.createElement)("div",{style:{margin:"0.5rem",display:"block"}},(0,e.createElement)("br",null),(0,e.createElement)(a.Button,{className:"components-button is-primary",onClick:t},(0,e.createElement)(a.Dashicon,{icon:"format-image"}),"Select Image"))}),(0,e.createElement)(a.Button,{onClick:V},"Cancel"))),"video"===m&&(0,e.createElement)(c,{onSelectVideo:S,selectedVideoCaption:g,selectedVideoLink:p,selectedVideoTitle:h,setSelectedVideoCaption:f,setSelectedVideoLink:b,setSelectedVideoTitle:v})))),(0,e.createElement)("div",{className:"block-preview wp-block",style:{border:"1px solid black",margin:"0.3rem"}},(0,e.createElement)("div",null,(0,e.createElement)("code",null,'PREVIEW PAGE TO VIEW MEDIA CAROUSEL "',N,'"'))))},save:({attributes:t})=>(0,e.createElement)(i,{attributes:t})})})();